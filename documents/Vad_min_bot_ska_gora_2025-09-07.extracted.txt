Vad min bot ska gÃ¶ra 2025-09-07

ğŸ“Œ Din Bots Funktioner och FullstÃ¤ndig Specifikation
Detta Ã¤r minimikraven. Nya funktioner som infÃ¶rs ska uppdateras hÃ¤r och aldrig tas bort ur botens funktioner eller dokumentation.

ğŸ“¨ Signalhantering

Botten tar emot endast Telegram-signaler som innehÃ¥ller: entry, TP och SL.

StÃ¶d fÃ¶r alla symbolformat:â€“ Alla USDT-par (t.ex. BTCUSDT, ETHUSDT).â€“ Ã„ven USD-par och namnformat (t.ex. Bitcoin, BTC/USDT).

Universell signalnormering (ingen whitelist)
Alla inkommande signaler â€“ oavsett kÃ¤lla/etikett (DCA, scale-in, add-on, ladder, grid, martingale, trailing-TP/SL m.fl.) â€“ mappas deterministiskt till kÃ¤rnfÃ¤lt {entry, TP[], SL, typ} enligt mall.â€“ Add-entry/DCA â†’ ENTRY (eller ENTRY n i dual-limit-plan).â€“ Partial-TP/scale-out â†’ TPn med explicit kvantitet/andel.â€“ Move-to-BE/trailing â†’ BREAK_EVEN_UPDATE/TRAILING_UPDATE relativt original-ENTRY.â€“ Saknas SL i kÃ¤llan â†’ auto-SL = âˆ’2,00 % frÃ¥n entry och FAST x10,00 (se Â§ HÃ¤vstÃ¥ng).

Normalisering av data (obligatoriskt)
Riktning (LONG/SHORT), tick size och qty step MÃ…STE normaliseras mot instrumentets specifikation innan orderlÃ¤ggning. Alla priser och kvantiteter kvantiseras till symbolens tick size respektive qty step.

DupliceringsspÃ¤rr
â€“ Om inkommande signal Ã¤r i princip identisk (entry/TP/SL diff â‰¤ 5 %) mot en aktiv/nyligen mottagen â†’ blockera i 2 timmar.â€“ Om diff â‰¥ 10 % â†’ acceptera alltid.â€“ Om diff i (5â€“10 %) â†’ accepteras eller blockeras deterministiskt enligt fast regel (ingen heuristik).â€“ Motsatt riktning (LONG/SHORT) â†’ accepteras alltid.
Deduplicering (metodkrav): UtÃ¶ver trÃ¶skelreglerna ska duplicering upptÃ¤ckas via HASH + tidsfÃ¶nster (TTL). HASH berÃ¤knas deterministiskt pÃ¥ {kÃ¤lla, symbol, side, entry, TP[], SL}. TTL = 2 timmar (konfigurerbar).

ğŸ“ˆ Dual-Limit Entry & Sammanslagning (OBLIGATORISKT)
Syfte: Alltid tvÃ¥ post-only GTC-limitordrar som ligger kvar oavsett aktuellt pris, invÃ¤ntar trÃ¤ff och slÃ¥s samman till en position dÃ¤r genomsnittlig entry = mittpunkten.

MÃ¥l-entry och spridningDefiniera mÃ¥l-entry Em och halvspridning Î” (pris, procent eller ticks).BerÃ¤kna tvÃ¥ tick-kvantiserade priser:P1 = quantize(Em âˆ’ Î”)P2 = quantize(Em + Î”)

Placering (side-beroende)â€“ LONG: lÃ¤gg bÃ¥da limit buy under LTP sÃ¥ att de inte fyller direkt.â€“ SHORT: lÃ¤gg bÃ¥da limit sell Ã¶ver LTP.

KvantitetTotal planerad kvantitet Q delas 50/50: q1 = Q/2, q2 = Q âˆ’ q1 (justera till minQty/qtyStep).

OrderlÃ¤ggningLÃ¤gg tvÃ¥ limitordrar med timeInForce = GTC, postOnly = true, reduceOnly = false.Spara respektive orderId. Inget Telegram-meddelande skickas hÃ¤r.

Sammanslagning vid fÃ¶rsta fillVid fÃ¶rsta fill (helt/delvis) hÃ¥lls ackumulerad fill f och pris-summa Î£(fill_qty * fill_price).FÃ¶r att garantera slutligt snitt = Em fÃ¶r total Q, rÃ¤kna ut ersÃ¤ttningspris fÃ¶r resterande Q âˆ’ f:pr = quantize((Em*Q âˆ’ Î£(fill_qty*fill_price)) / (Q âˆ’ f))Avbryt den andra ursprungsordern (om Ã¶ppen) och lÃ¤gg en ny post-only GTC-limit pÃ¥ pr fÃ¶r Q âˆ’ f.Om bÃ¥da ursprungsordrar delvis fyllt anvÃ¤nds totalsummor; lÃ¤gg ersÃ¤ttningsorder endast om f < Q.

Precision & maker-skyddPris kvantiseras till symbolens tick size. Kvantitet kvantiseras till qty step.postOnly fÃ¥r inte brytas; justera pris 1 tick frÃ¥n spreaden vid behov.

ğŸ§® Dynamisk hÃ¤vstÃ¥ng (ENTYDIG FORMEL)
DefinitionerB = kontosaldo (USDT), r = risk per trade (andel),E = entry-pris, S = stop-loss-pris,Delta = abs(E âˆ’ S) / E,IM_plan = planerad initial IM (USDT) fÃ¶r Ã¶ppningsordern.
BerÃ¤kningarN = (r * B) / DeltaLev_dyn = round(min(max(N / IM_plan, 1), 50), 2)
Klassning & format

SWING: Lev â‰¤ 6,00Ã— â†’ klassas och publiceras som SWING.

DYNAMISK: Lev â‰¥ 7,50Ã— â†’ klassas och publiceras som DYNAMISK.

MellanomrÃ¥de: Lev i (6,00Ã—; 7,50Ã—) â†’ klassas till nÃ¤rmsta av SWING/DYNAMISK.

Fallback: saknas SL i kÃ¤llan â†’ FAST med SL = âˆ’2,00 % frÃ¥n entry och x10,00 hÃ¤vstÃ¥ng.

Formatering: hÃ¤vstÃ¥ng visas alltid med tvÃ¥ decimaler (xNN.NN). Procenttal visas med tvÃ¥ decimaler (t.ex. âˆ’2,00 %).

ğŸ”„ End-to-end-flÃ¶de & kvittenspolicy (Bybit fÃ¶rst)
Kedja

Ingest frÃ¥n kÃ¤llgrupp â†’ Parser/Normalisering â†’ Validering â†’ Mallbyggare.

OrderlÃ¤ggning mot Bybit (POST) enligt mall.

VÃ¤nta pÃ¥ kvittens frÃ¥n Bybit (API/WS) fÃ¶r varje steg:â€“ ORDER_ACCEPTED: retCode = 0 och giltiga order-/position-ID.â€“ TP_SL_SET: samtliga TP/SL-order bekrÃ¤ftade.â€“ POSITION_OPENED: verifierad fill (executedQty > 0) eller WS-event.

Telegram-publicering sker endast efter bekrÃ¤ftelse i respektive steg.

Livscykeluppdateringar (BE-flytt, trailing, partial fills, stÃ¤ngning via TP/SL) fÃ¶ljer samma Bybit-fÃ¶rst-princip.

Avslut: slutmeddelande nÃ¤r position stÃ¤ngts helt, inklusive PnL-summering och relevanta ID.
Tvingande mallheader (Ã¶verst i samtliga mallar)SÃ„NDS ENDAST EFTER BYBIT-BEKRÃ„FTELSE (retCode=0/fills).Varje fÃ¤lt i meddelandet fylls frÃ¥n Bybit-kvittens eller berÃ¤kning som refereras av Bybit-data. Ingen antagandepublicering.

ğŸ§¾ Obligatoriska fÃ¤lt i alla mallar (SSoT = Bybit)
Identitet & spÃ¥rbarhetbot_order_id, bybit_order_id (nÃ¤r tillgÃ¤nglig), position_id (om tillÃ¤mpligt),source_channel_name, signal_message_id, parsed_at, sent_at, env (prod/stage).
Handelsdatasymbol, side, entry_price, sl_price,tp_list[] (pris, % frÃ¥n entry, kvantitet/andel),leverage_class âˆˆ {SWING, DYNAMISK, FAST}, leverage_value (tvÃ¥ decimaler),order_type, time_in_force, post_only, reduce_only, margin_mode,risk_percent (= r), wallet_balance_snapshot (= B), im_plan (= IM_plan),delta (= Delta), notional_target (= N).
Kvittensflaggor (sÃ¤tts av kvittens, aldrig antaganden)order_accepted, tp_sl_set, position_opened, position_closed,be_moved, trailing_active (om tillÃ¤mpligt).

âœ… Validering fÃ¶re sÃ¤ndning (HÃ…RDA KRAV)
FÃ¥r inte publiceras till Telegram om nÃ¥got av fÃ¶ljande gÃ¤ller:

SL saknas och FAST-fallback (âˆ’2,00 %, x10,00) inte tillÃ¤mpats.

HÃ¤vstÃ¥ng utan tvÃ¥ decimaler eller utanfÃ¶r [1, 50] efter klampning.

TP-lista fel: prisordning, procentmÃ¤rkning, kvantiteter/andelar.

risk_percent, wallet_balance_snapshot, im_plan, delta saknas eller = 0.

Summa TP-kvantiteter Ã¶verstiger planerad positionsstorlek.

reduce_only/post_only inkonsistenta med ordertyp.

Tick size/qty-precision bryter mot instrumentregler.

TP/SL ej exakt enligt signal (fÃ¶rutom vid auto-SL-fallback) â†’ STOPPA publicering.

Exitorder utan reduce_only = true â†’ STOPPA publicering.

ğŸ§® BerÃ¤knings- och formateringspolicy (PRECIS)

HÃ¤vstÃ¥ng: enligt formeln; klampas [1, 50]; avrundas HALF-UP till 2 decimaler; visas xNN.NN.

Procent: alltid tvÃ¥ decimaler och % (t.ex. +2,98 %).

Pris: kvantiseras till Bybits tick size fÃ¶re sÃ¤ndning och vid varje uppdatering.

Kvantiteter: kvantiseras till instrumentets min/step.

Valuta: interna berÃ¤kningar i USDT (om inget annat anges).

ğŸ§° Konflikt- och fallbackregler (DETERMINISTISKT)

Saknas SL â†’ FAST-fallback (SL âˆ’2,00 %, x10,00).

Lev i (6,00Ã—; 7,50Ã—) â†’ klassas till nÃ¤rmsta klass.

Om Bybit returnerar avvikande vÃ¤rden (t.ex. justerad kvantitet/hÃ¤vstÃ¥ng) â†’ uppdatera interna fÃ¤lt och mall innan publicering.

ğŸ›°ï¸ Telemetri & revisionsspÃ¥r

Logga alla inkommande signaler, normaliserat utfall, berÃ¤knings-input/output (B, r, IM_plan, Delta, N, hÃ¤vstÃ¥ng), API-payloads till Bybit, rÃ¥a API-svar, WS-event, tidsstÃ¤mplar och alla publicerade Telegram-meddelanden.

Alla loggar mÃ¥ste korrelera bot_order_id â†” bybit_order_id/position_id.

ğŸ“£ Telegram-rapportering

LÃ¶pande meddelanden fÃ¶r alla hÃ¤ndelser: signal, order, entry, TP, SL, hedge, pyramid, trailing, re-entry.

Daglig rapport: totalt antal trades, winrate, PnL, antal re-entries/hedges/pyramidnivÃ¥er.

Veckorapport: som ovan + topplista Ã¶ver mest lÃ¶nsamma symboler.

Driftmeddelande var 30:e minut: bekrÃ¤ftar att boten Ã¤r online och visar korrekt tid/uptime.

ğŸ“¡ Telegram-flÃ¶de (inkoppling & uppstart)
KÃ¤llor Whitelist: â€œAllatelegram  kÃ¤llor i ALL_PARAMETERSâ€ ingÃ¥r i SSoT, inga externa kÃ¤llor. MÃ…STE vara whitelistrade och ingÃ¥ i vÃ¥r SSoT (Single Source of Truth).
Vid uppkoppling (obligatorisk utskrift â€“ â€grÃ¶n bockâ€):Vid start/Ã¥terstart ska boten omedelbart skriva ut till privat kanal, med Bybit/Telegram-bekrÃ¤ftelse per rad (âœ…):â€“ PlÃ¥nbokssaldo (baseline): 402.10 USDT (SSoT) âœ…â€“ RiskinstÃ¤llningar (t.ex. 2 % per trade) âœ…â€“ Strategier som Ã¤r aktiva âœ…â€“ Aktiva positioner & Ã¶ppna ordrar (sammanfattning) âœ…All data MÃ…STE vara bekrÃ¤ftad mot Bybit (API/WS) och kÃ¤ll-Telegram. Inga antaganden fÃ¥r publiceras.
VidaresÃ¤ndning till privat kanal:Alla godkÃ¤nda och normaliserade signaler skickas till privat kanal i standardformat (mallad). Publicering sker endast efter Bybit-bekrÃ¤ftelse enligt kvittenspolicyn.
Felaktiga signaler:Felaktiga/inkompletta signaler skickas rÃ¥a till privat kanal med tydlig felmarkering (orsak och vilka fÃ¤lt som fallerat).

âš™ï¸ DriftsÃ¤kerhet

Standardiserade felmeddelanden (varning/kritiskt).

Snabb exekvering utan brus.

Minnessanering: ta bort signaler som inte gÃ¥r igenom inom normal tid; rensa ordrar som inte blir positioner.

Fail-safe: vid avbrott (internet, API-fel, bot-hÃ¤ngning) Ã¥terupptas aktiva positioner och SL/TP; automatisk reconnect; saldo-/positionsverifiering vid Ã¥teranslutning; spÃ¤rr mot orderloopar.
Order-stÃ¤dning (timeouts):Ej fyllda ordrar ska stÃ¤das idempotent enligt fÃ¶ljande timeouts:â€“ 24h: korttimeout fÃ¶r hÃ¤ngande Ã¶ppningsordrar och partiellt fyllda ordrar (re-query + cancel).â€“ 6d: lÃ¥ngtidsrensning av kvarvarande ordrar som inte resulterat i position.Dessa jobb MÃ…STE vara persistenta och automatiskt Ã¥terupptas efter omstart.

ğŸ“‰ Stop Loss & Dynamik

Alla SL-justeringar baseras pÃ¥ original-entry (inte justerad entry).

Flytta SL till BE eller till TP1 â†’ tolkas och utfÃ¶rs.

Positionens storlek och SL berÃ¤knas dynamiskt utifrÃ¥n B, r, IM_plan, E, S.

NÃ¤r TP2 trÃ¤ffas â†’ SL flyttas till BE + kostnad (0,0015 %).

SL fÃ¶rflyttas dÃ¤refter enligt faststÃ¤llda pyramid- och **trailing-**regler.

ğŸ”€ Pyramid- & hÃ¤vstÃ¥ngsregler

Alla pyramidnivÃ¥er rÃ¤knas om frÃ¥n original-entry.

Stege (exempel):+1,5 % â†’ IM = 20 USDT+2,3 % â†’ SL = BE + kostnad+2,4 % â†’ hÃ¤vstÃ¥ng upp till max (50Ã—)+2,5 % â†’ IM = 40 USDT+4 % â†’ IM = 60 USDT+6 % â†’ IM = 80 USDT+8,6 % â†’ IM = 100 USDT

HÃ¤vstÃ¥ngsklassificering:â‰¤ 6Ã— â†’ SWINGâ‰¥ 7,5Ã— â†’ DYNAMISK6â€“7,5Ã— â†’ klassas till nÃ¤rmaste enligt Â§ Dynamisk hÃ¤vstÃ¥ng.

ğŸ“Š Trailing Stop

Vid +6,1 % orealiserad vinst aktiveras trailing stop.

SL placeras 2,5 % bakom hÃ¶gsta priset (eller lÃ¤gsta vid SHORT) och fÃ¶ljer priset lÃ¶pande.

ğŸ”„ Hedge & Re-entry

Om priset rÃ¶r sig âˆ’2 % mot positionen: Ã¶ppna hedge i motsatt riktning.â€“ Storlek = 100 % av ursprunglig position.â€“ TP = original-SL, SL = original-entry.

Efter SL-trÃ¤ff: fÃ¶rsÃ¶k re-entry med dual-limit upp till 3 gÃ¥nger; dÃ¤refter stopp tills ny extern signal anlÃ¤nder.

Hedge-positioner anvÃ¤nder samma hÃ¤vstÃ¥ng som originalpositionen.

ğŸ“‹ Risk & Kapacitet

Max 100 aktiva trades samtidigt.

Ingen daglig/veckovis fÃ¶rlustspÃ¤rr stoppar boten.

Basparametrar (SSoT-baseline):â€“ Konto: 402.10 USDTâ€“ Risk: 2 % per tradeâ€“ Initial IM: 20 USDT per trade

ğŸ”¤ Terminologi (konsekvent)

AnvÃ¤nd konsekvent termen SSoT (Single Source of Truth) i hela dokumentet. ErsÃ¤tt eventuella varianter (SSOT, SSoS, ssos) med SSoT (Single Source of Truth).

Kontrollista â€“ allt infÃ¶rt:âœ” 3 whitelistrade kÃ¤llor i SSoT â€¢ âœ” Uppstartsutskrift med â€grÃ¶n bockâ€ och baseline 402.10 USDT â€¢ âœ” Normalisering LONG/SHORT + tick/step â€¢ âœ” Dedup: HASH + TTL 2h â€¢ âœ” Dual-Limit + sammanslagning â€¢ âœ” TP/SL exakt enligt signal (undantag auto-SL) â€¢ âœ” Exit = reduce_only=true â€¢ âœ” Valideringsbrytare fÃ¶r bÃ¥da ovan â€¢ âœ” Timeouts 24h/6d, persistenta â€¢ âœ” Bybit-fÃ¶rst och tvingande mallheader â€¢ âœ” Terminologi SSoT konsekvent.
hÃ¤r).

ğŸ—‚ï¸ A) RÃ¤tta din befintliga â€œLoggningâ€-sektion

Vad som mÃ¥ste Ã¤ndras

Frasen â€œTelegram-notifieringar â€¦ skickas alltidâ€ strider mot Bybit-fÃ¶rst. Ska vara: skickas endast efter kvittens; felmeddelanden Ã¤r egna notifieringar.

FÃ¶rtydliga tidsstÃ¤mpelpolicy: UTC som standard, alternativ lokal tidszon (Europe/Stockholm) via konfig.

ErsÃ¤tt hela â€œLoggningâ€ med:

Loggning

â€¢ Alla hÃ¤ndelser pÃ¥ Bybit loggas:

  â€“ Orderplacering (request/payload)

  â€“ Orderaccept (retCode, orderId)

  â€“ Orderfill (WS/REST fills)

  â€“ SL/TP-trigger (skapande, uppdatering, fill)

  â€“ Felmeddelanden (klass: varning/kritiskt)

  â€“ Reconnects (WS/REST), backoff och Ã¥terhÃ¤mtning

â€¢ Loggar sparas lokalt och Ã¤r kompletta (fÃ¶rlustfria) samt korreleras via bot_order_id â†” bybit_order_id/position_id.

â€¢ Telegram-notifieringar fÃ¶ljer standardiserade mallar och skickas ENDAST efter Bybit-kvittens (Bybit fÃ¶rst). Felnotifieringar skickas separat.

â€¢ Alla loggar och meddelanden tidsstÃ¤mplas i UTC (standard). Lokal tidszon kan aktiveras via konfig (Europe/Stockholm).

B) LÃ¤gg till under â€œğŸ“¨ Signalhanteringâ€

1) Direkt efter fÃ¶rsta stycket (om att ta emot Telegram-signaler):

Standardisering av utgÃ¥ende meddelanden

Inga rÃ¥-forward frÃ¥n kÃ¤llkanaler. Alla meddelanden som skickas vidare till vÃ¥ra grupper MÃ…STE skapas frÃ¥n vÃ¥ra standardiserade mallar och innehÃ¥lla samtliga berÃ¤knade fÃ¤lt (ingen kopierad text).

2) Efter symbolstÃ¶det (binder flÃ¶den till SSoT):

Kategori & flÃ¶den (SSoT)

Botens marknadsflÃ¶den Ã¤r anslutna till Bybit v5 linear (USDT-perpetual) public-WS. Detta pÃ¥verkar inte tolkningen av inkommande signalformat men styr tick/step-normalisering och instrumentspecifikationer.

C) â€œğŸ“ˆ EntrÃ© & OrderlÃ¤ggningâ€ â€“ infoga bekrÃ¤ftelsekedja

Placering: efter inledningen i avsnittet

BekrÃ¤ftelsekrav fÃ¶re publicering (Bybit fÃ¶rst)

â€“ ORDER_PLACED publiceras ENDAST efter Bybit-svar med retCode=0 och giltigt orderId.

â€“ POSITION_OPENED publiceras ENDAST efter privat WS-event eller polling som bekrÃ¤ftar att positionen faktiskt Ã¤r Ã¶ppnad (executedQty > 0).

â€“ TP_SL_SET publiceras ENDAST efter bekrÃ¤ftelse pÃ¥ att samtliga TP/SL-order Ã¤r skapade/uppdaterade.

D) Ny rubrik: â€œğŸ“£ Telegrammallar (obligatoriska fÃ¤lt)â€

(Om du inte vill ha ny rubrik kan detta lÃ¤ggas i slutet av â€œğŸ“ˆ EntrÃ© & OrderlÃ¤ggningâ€.)

ğŸ“£ Telegrammallar (obligatoriska fÃ¤lt)

FÃ¶ljande placeholders MÃ…STE finnas och vara ifyllda vid publicering:

{order_id}, {post_only}, {reduce_only}, {im_confirmed}, {source_channel_name}.

{im_confirmed} hÃ¤mtas uttryckligen frÃ¥n Bybit-respons/positionsdata (fÃ¥r EJ antas eller lokalt berÃ¤knas). Tomt/Null/None/"" Ã¤r inte tillÃ¥tet.

E) Ny rubrik: â€œğŸ” KÃ¤llor & Telegram-klientâ€

Viktigt om konflikt: Tidigare beslut var â€Endast tre (3) kÃ¤llorâ€. Nedan lÃ¥ser vi exakt tre och namnger dem. (Ta bort alla formuleringar som antyder â€ytterligare kÃ¤llor kan fÃ¶rekommaâ€.)

ğŸ” KÃ¤llor & Telegram-klient

â€¢ Telegram-klient: Endast Pyrogram fÃ¥r anvÃ¤ndas.

â€¢ KÃ¤llor (whitelist, SSoT): Endast tre (3) definierade kÃ¤llor bevakas och processas:

  â€“ CRYPTORAKETEN

  â€“ LUX_LEAK

  â€“ SMART_CRYPTO

â€¢ Alla Telegram-parametrar fÃ¶r dessa kÃ¤llor (channel_id, title, username, invite_link m.fl.) MÃ…STE vara whitelistrade i SSoT (Single Source of Truth).

â€¢ Ã„ndringar av kÃ¤llor krÃ¤ver Ã¤garens uttryckliga godkÃ¤nnande och SSoT-uppdatering i signerad release (se â€œğŸš¦ SÃ¤ker start / produktionâ€).

F) Ny rubrik: â€œğŸ§ª Dubblett- och variantkontrollâ€

HÃ¤r harmoniserar vi varianter: svensk standard SWING, DYNAMISK, FAST. (Om du har Ã¤ldre text med DYNAMIC/FIXED: ersÃ¤tt dem med DYNAMISK/FAST.)

ğŸ§ª Dubblett- och variantkontroll

â€¢ Signalvarianter (tillÃ¥tna): SWING, DYNAMISK, FAST. (Synonymer: DYNAMIC â†’ DYNAMISK, FIXED â†’ FAST.)

â€¢ Andra varianter Ã¤r inte tillÃ¥tna i mallar eller runtime.

â€¢ Deduplicering: som i â€œDupliceringsspÃ¤rrâ€ + HASH+TTL (2h) enligt SSoT.

G) Ny rubrik: â€œğŸš¦ SÃ¤ker start / produktionâ€

ğŸš¦ SÃ¤ker start / produktion

Bot fÃ¥r kÃ¶ras mot mainnet endast nÃ¤r en signerad release valideras med en governance-token (kontrolleras i driftkoden). I annat fall kÃ¶rs boten i demolÃ¤ge. Denna regel Ã¤r process- och sÃ¤kerhetsrelaterad; inga API-nycklar eller hemligheter dokumenteras hÃ¤r.

Sammanfattande check (Telegram-krav uppdaterade korrekt)

âœ… Bybit-fÃ¶rst Ã¥terspeglas i Loggning och BekrÃ¤ftelsekrav fÃ¶re publicering.

âœ… Inga rÃ¥-forward: Standardisering av utgÃ¥ende meddelanden infÃ¶rd i Signalhantering.

âœ… MallfÃ¤lt fÃ¶r Telegram (inkl. {im_confirmed} frÃ¥n Bybit) definierade.

âœ… KÃ¤lla-whitelist: exakt 3 kÃ¤llor namngivna, Pyrogram-krav tydligt, kopplade till SSoT.

âœ… Varianter lÃ¥sta: SWING, DYNAMISK, FAST (med synonym-mappning).

âœ… FlÃ¶desbindning till Bybit v5 linear i Signalhantering.

âœ… Governance-gate fÃ¶r produktion tillagd.

Synkpunkter att spegla fullt ut i styrdokumenten

Dual-Limit & Sammanslagning med Î” och páµ£-formeln; postOnly=true, GTC, 50/50; maker-skydd (tick-justering) 
Vad min bot ska gÃ¶ra 2025-09-07
.

Dynamisk hÃ¤vstÃ¥ng (formeln, klampning, klassning SWING â‰¤ 6.00Ã— / DYNAMISK â‰¥ 7.50Ã— / FAST fallback vid saknat SL = âˆ’2.00 %, x10.00) 
Vad min bot ska gÃ¶ra 2025-09-07
.

Bybit-fÃ¶rst-flÃ¶de och tvingande mallheadern 
Vad min bot ska gÃ¶ra 2025-09-07
.

Dedup HASH + TTL 2h utÃ¶ver procenttrÃ¶sklarna 
Vad min bot ska gÃ¶ra 2025-09-07
.

Exits reduce_only=true och TP/SL exakt enligt signal (undantag: auto-SL fallback) 
Vad min bot ska gÃ¶ra 2025-09-07
.

Timeouts 24h/6d fÃ¶r orderstÃ¤dning (persistenta jobb) 
Vad min bot ska gÃ¶ra 2025-09-07
.

Uppstart (grÃ¶n bock) med baseline 402.10 USDT och Bybit/Telegram-kvittens per rad â€“ ska Ã¥terfinnas i Runbook och README (startsektion) 

TillÃ¤gg som mÃ¥ste in i Word-dokumenten (fÃ¶r full spegling)
LÃ¤gg in fÃ¶ljande textavsnitt i â€Vad min bot ska gÃ¶raâ€ och vid behov i â€Telegram meddelamndeâ€:

Pyrogram-exklusivitetâ€Telegram-klient: Endast Pyrogram anvÃ¤nds. Andra klienter (t.ex. Telethon) Ã¤r fÃ¶rbjudna.â€

Dual-Limit & Merge (ersÃ¤tter Above/Below)â€Orderplan: Dual-Limit & sammanslagning (Î”-modell). TvÃ¥ Post-Only GTC-entry kring mÃ¥lnivÃ¥ Eâ‚˜ Â± Î”. Merge-on-first-fill sÃ¤krar slutligt avg_entry = Eâ‚˜. Above/Below fÃ¶rekommer inte i systemet.â€

Startup-baseline + headerkravâ€Startup-meddelande visar Balance baseline: 402.10 USDT (SSoT) âœ… och Cleanup-timeouts: 24h/6d. Alla driftmallar har topp-raden â€™SÃ„NDS ENDAST EFTER BYBIT-BEKRÃ„FTELSEâ€™.â€

TP/SL-exakthetâ€TP och SL sÃ¤tts exakt enligt signal. Undantag: saknas SL i kÃ¤llan â†’ auto-SL = âˆ’2,00 % och hÃ¤vstÃ¥ng FAST x10,00.â€

DEMO-lÃ¥sâ€DriftmiljÃ¶: Bybit DEMO endast. Alla REST/WS-endpoints Ã¤r DEMO. (Production krÃ¤ver separat governance-frigivning.)â€

Prestanda/â€snabb botâ€â€Krav: REST-latens â‰¤ 500 ms p95, WS-heartbeat â‰¤ 30 s, effektiv rate-limit-hantering, inga blockande proppar i huvudloopen. Avvikelse â‡’ drift blockeras tills Ã¥tgÃ¤rdat.â€

Manuella kontrollerâ€All verifiering i drift sker manuellt, steg fÃ¶r steg, med efterkontroll fÃ¶re nÃ¤sta moment. Inga automatiserade tester i produktion.â€

Extra: saker som â€œska in i Wordâ€ om de inte redan finns
(De flesta finns redan, men lÃ¤gg till om nÃ¥got saknas.)

Presentation-standard fÃ¶r Telegram (svenska) â€“ en normativ rad i Word om komma som decimal och mellanslag fÃ¶re % samt xNN,NN fÃ¶r hÃ¤vstÃ¥ng. 
Telegram meddelamnde

Startvillkor i klartext: retCode=0, RESTâ‰¤500 ms p95, WSâ‰¤30 s, can_send=true, governance OK, JSONL-loggning med message_text_hash och trace_id. (Det stÃ¥r i din engelska startmall; spegla pÃ¥ svenska i

2) Vad min bot ska gÃ¶ra 2025-09-07.docx â€” OK, men fÃ¶rstÃ¤rkningar
Detta Word-dokument innehÃ¥ller i princip alla krav vi baserar styrdokumenten pÃ¥: Pyrogram-exklusivitet, 3 kÃ¤llor (whitelist/SSoT), Dual-Limit Î”-modellen, Dynamisk hÃ¤vstÃ¥ng (Î”), Bybit-fÃ¶rst + header, Dedup HASH+TTL 2h, reduce_only pÃ¥ exits, TP/SL exakt, timeouts 24h/6d, startup baseline 402,10 och prestandatrÃ¶sklar + manuell kontroll.
Rekommenderad minijustering (valfri tydliggÃ¶rande):

LÃ¤gg in en kort normrad fÃ¶r svenska Telegram-format (decimaltecken, mellanslag fÃ¶re %) direkt i avsnittet om mallar, sÃ¥ det inte kan misstolkas. (Det hÃ¤nger redan i â€œTelegram meddelamndeâ€, men bra att spegla satsen hÃ¤r ocksÃ¥.) 
Telegram meddelamnde
I Ã¶vrigt: ingen Ã¤ndring nÃ¶dvÃ¤ndig; detta Ã¤r kÃ¤ll-SSoT.
ENGLISH+46
703
689310
What my bot must do 2025-09-07
ğŸ“Œ Your Botâ€™s Functions and Full Specification
These are the minimum requirements. New features that are introduced must be updated here and must never be removed from the botâ€™s functions or documentation.
ğŸ“¨ Signal Handling
The bot receives only Telegram signals that contain: entry, TP and SL.
Support for all symbol formats:â€“ All USDT pairs (e.g. BTCUSDT, ETHUSDT).â€“ Also USD pairs and name formats (e.g. Bitcoin, BTC/USDT).
Universal signal normalization (no whitelist)
All incoming signals â€“ regardless of source/label (DCA, scale-in, add-on, ladder, grid, martingale, trailing-TP/SL etc.) â€“ are deterministically mapped to the core fields {entry, TP[], SL, type} according to a template.â€“ Add-entry/DCA â†’ ENTRY (or ENTRY n in dual-limit plan).â€“ Partial-TP/scale-out â†’ TPn with explicit quantity/share.â€“ Move-to-BE/trailing â†’ BREAK_EVEN_UPDATE/TRAILING_UPDATE relative to the original ENTRY.â€“ If SL is missing in the source â†’ auto-SL = âˆ’2.00 % from entry and FAST x10.00 (see Â§ Leverage).
Data normalization (mandatory)
Direction (LONG/SHORT), tick size and qty step MUST be normalized against the instrument specification before order placement. All prices and quantities are quantized to the symbolâ€™s tick size and qty step respectively.
Duplication guard
â€“ If the incoming signal is essentially identical (entry/TP/SL diff â‰¤ 5 %) to an active/recently received one â†’ block for 2 hours.â€“ If diff â‰¥ 10 % â†’ always accept.â€“ If diff in (5â€“10 %) â†’ accepted or blocked deterministically according to fixed rule (no heuristics).â€“ Opposite direction (LONG/SHORT) â†’ always accepted.
Deduplication (method requirement): In addition to the threshold rules, duplication must be detected via HASH + time window (TTL). HASH is calculated deterministically on {source, symbol, side, entry, TP[], SL}. TTL = 2 hours (configurable).
ğŸ“ˆ Dual-Limit Entry & Merging (MANDATORY)
Purpose: Always two post-only GTC limit orders that remain regardless of current price, wait to be hit and are merged into one position where the average entry = the midpoint.
Target entry and spreadDefine target entry Em and half-spread Î” (price, percent or ticks).Calculate two tick-quantized prices:P1 = quantize(Em âˆ’ Î”)P2 = quantize(Em + Î”)
Placement (side-dependent)â€“ LONG: place both limit buys below LTP so that they do not fill immediately.â€“ SHORT: place both limit sells above LTP.
QuantityTotal planned quantity Q is split 50/50: q1 = Q/2, q2 = Q âˆ’ q1 (adjust to minQty/qtyStep).
Order placementPlace two limit orders with timeInForce = GTC, postOnly = true, reduceOnly = false.Save each orderId. No Telegram message is sent here.
Merging on first fillOn first fill (full/partial) keep accumulated fill f and price-sum Î£(fill_qty * fill_price).To guarantee final average = Em for total Q, calculate replacement price for remaining Q âˆ’ f:pr = quantize((EmQ âˆ’ Î£(fill_qtyfill_price)) / (Q âˆ’ f))Cancel the other original order (if open) and place a new post-only GTC limit at pr for Q âˆ’ f.If both original orders have partially filled, use the total sums; place replacement order only if f < Q.
Precision & maker protectionPrice is quantized to the symbolâ€™s tick size. Quantity is quantized to qty step.postOnly must not be broken; adjust price 1 tick from the spread if needed.
ğŸ§® Dynamic Leverage (UNAMBIGUOUS FORMULA)
DefinitionsB = account balance (USDT), r = risk per trade (fraction),E = entry price, S = stop-loss price,Delta = abs(E âˆ’ S) / E,IM_plan = planned initial IM (USDT) for the opening order.
CalculationsN = (r * B) / DeltaLev_dyn = round(min(max(N / IM_plan, 1), 50), 2)
Classification & format
SWING: Lev â‰¤ 6.00Ã— â†’ classified and published as SWING.
DYNAMIC: Lev â‰¥ 7.50Ã— â†’ classified and published as DYNAMIC.
Intermediate range: Lev in (6.00Ã—; 7.50Ã—) â†’ classified to the nearest of SWING/DYNAMIC.
Fallback: SL missing in source â†’ FAST with SL = âˆ’2.00 % from entry and x10.00 leverage.
Formatting: leverage is always shown with two decimals (xNN.NN). Percent values are shown with two decimals (e.g. âˆ’2.00 %).
ğŸ”„ End-to-end Flow & Acknowledgement Policy (Bybit first)
Chain
Ingest from source group â†’ Parser/Normalization â†’ Validation â†’ Template builder.
Order placement to Bybit (POST) according to template.
Wait for acknowledgement from Bybit (API/WS) for every step:â€“ ORDER_ACCEPTED: retCode = 0 and valid order/position IDs.â€“ TP_SL_SET: all TP/SL orders confirmed.â€“ POSITION_OPENED: verified fill (executedQty > 0) or WS event.
Telegram publishing takes place only after confirmation in the respective step.
Lifecycle updates (BE move, trailing, partial fills, closing via TP/SL) follow the same Bybit-first principle.
Closing: final message when position has been fully closed, including PnL summary and relevant IDs.
Mandatory template header (at the top of all templates)SENT ONLY AFTER BYBIT CONFIRMATION (retCode=0/fills).Each field in the message is populated from Bybit acknowledgement or calculation that is referenced by Bybit data. No assumption-based publishing.
ğŸ§¾ Mandatory Fields in All Templates (SSoT = Bybit)
Identity & traceabilitybot_order_id, bybit_order_id (when available), position_id (when applicable),source_channel_name, signal_message_id, parsed_at, sent_at, env (prod/stage).
Trading datasymbol, side, entry_price, sl_price,tp_list[] (price, % from entry, quantity/share),leverage_class âˆˆ {SWING, DYNAMIC, FAST}, leverage_value (two decimals),order_type, time_in_force, post_only, reduce_only, margin_mode,risk_percent (= r), wallet_balance_snapshot (= B), im_plan (= IM_plan),delta (= Delta), notional_target (= N).
Acknowledgement flags (set by acknowledgement, never assumptions)order_accepted, tp_sl_set, position_opened, position_closed,be_moved, trailing_active (when applicable).
âœ… Validation Before Sending (HARD REQUIREMENTS)
Must not be published to Telegram if any of the following applies:
SL is missing and FAST fallback (âˆ’2.00 %, x10.00) has not been applied.
Leverage without two decimals or outside [1, 50] after clamping.
TP list errors: price order, percent labeling, quantities/shares.
risk_percent, wallet_balance_snapshot, im_plan, delta are missing or = 0.
Sum of TP quantities exceeds planned position size.
reduce_only/post_only inconsistent with order type.
TP/SL not exactly according to signal (except in auto-SL fallback) â†’ STOP publishing.
Exit orders without reduce_only = true â†’ STOP publishing.
ğŸ§® Calculation and Formatting Policy (PRECISE)
Leverage: according to formula; clamped [1, 50]; rounded HALF-UP to 2 decimals; displayed xNN.NN.
Percent: always two decimals and % (e.g. +2.98 %).
Price: quantized to Bybitâ€™s tick size before sending and at every update.
Quantities: quantized to the instrumentâ€™s min/step.
Currency: internal calculations in USDT (unless otherwise stated).
ğŸ§° Conflict and Fallback Rules (DETERMINISTIC)
SL missing â†’ FAST fallback (SL âˆ’2.00 %, x10.00).
Lev in (6.00Ã—; 7.50Ã—) â†’ classified to closest class.
If Bybit returns deviating values (e.g. adjusted quantity/leverage) â†’ update internal fields and template before publishing.
ğŸ›°ï¸ Telemetry & Audit Trail
Log all incoming signals, normalized outcome, calculation input/output (B, r, IM_plan, Delta, N, leverage), API payloads to Bybit, raw API responses, WS events, timestamps and all published Telegram messages.
All logs must correlate bot_order_id â†” bybit_order_id/position_id.
ğŸ“£ Telegram Reporting
Continuous messages for all events: signal, order, entry, TP, SL, hedge, pyramid, trailing, re-entry.
Daily report: total number of trades, win rate, PnL, number of re-entries/hedges/pyramid levels.
Weekly report: as above + leaderboard of most profitable symbols.
Operations message every 30 minutes: confirms that the bot is online and shows correct time/uptime.
ğŸ“¡ Telegram Flow (connection & startup)
Sources Whitelist: â€œAll Telegram sources in ALL_PARAMETERSâ€ are included in SSoT, no external sources. MUST be whitelisted and included in our SSoT (Single Source of Truth).
On connection (mandatory print â€“ â€œgreen checkâ€):On start/restart the bot must immediately print to the private channel, with Bybit/Telegram confirmation per line (âœ…):â€“ Wallet balance (baseline): 402.10 USDT (SSoT) âœ…â€“ Risk settings (e.g. 2 % per trade) âœ…â€“ Strategies that are active âœ…â€“ Active positions & open orders (summary) âœ…All data MUST be confirmed against Bybit (API/WS) and source Telegram. No assumptions may be published.
Forwarding to private channel:All approved and normalized signals are sent to the private channel in standard format (templated). Publishing takes place only after Bybit confirmation according to the acknowledgement policy.
Erroneous signals:Erroneous/incomplete signals are sent raw to the private channel with clear error marking (reason and which fields failed).
âš™ï¸ Operational Reliability
Standardized error messages (warning/critical).
Fast execution without noise.
Memory cleanup: remove signals that do not pass within normal time; clean up orders that do not become positions.
Fail-safe: in case of interruption (internet, API error, bot freeze) active positions and SL/TP are resumed; automatic reconnect; balance/position verification on reconnection; guard against order loops.
Order cleanup (timeouts):Unfilled orders must be cleaned up idempotently according to the following timeouts:â€“ 24h: short timeout for hanging opening orders and partially filled orders (re-query + cancel).â€“ 6d: long-term cleanup of remaining orders that did not result in a position.These jobs MUST be persistent and automatically resumed after restart.
ğŸ“‰ Stop Loss & Dynamics
All SL adjustments are based on original entry (not adjusted entry).
Move SL to BE or to TP1 â†’ interpreted and executed.
Position size and SL are calculated dynamically based on B, r, IM_plan, E, S.
When TP2 is hit â†’ SL is moved to BE + cost (0.0015 %).
SL is thereafter moved according to fixed pyramid and trailing rules.
ğŸ”€ Pyramid & Leverage Rules
All pyramid levels are recalculated from original entry.
Ladder (example):+1.5 % â†’ IM = 20 USDT+2.3 % â†’ SL = BE + cost+2.4 % â†’ leverage up to max (50Ã—)+2.5 % â†’ IM = 40 USDT+4 % â†’ IM = 60 USDT+6 % â†’ IM = 80 USDT+8.6 % â†’ IM = 100 USDT
Leverage classification:â‰¤ 6Ã— â†’ SWINGâ‰¥ 7.5Ã— â†’ DYNAMIC6â€“7.5Ã— â†’ classified to nearest according to Â§ Dynamic Leverage.
ğŸ“Š Trailing Stop
At +6.1 % unrealized profit the trailing stop is activated.
SL is placed 2.5 % behind the highest price (or lowest for SHORT) and follows the price continuously.
ğŸ”„ Hedge & Re-entry
If the price moves âˆ’2 % against the position: open hedge in the opposite direction.â€“ Size = 100 % of the original position.â€“ TP = original SL, SL = original entry.
After SL hit: attempt re-entry with dual-limit up to 3 times; thereafter stop until a new external signal arrives.
Hedge positions use the same leverage as the original position.
ğŸ“‹ Risk & Capacity
Max 100 active trades simultaneously.
No daily/weekly loss cap stops the bot.
Base parameters (SSoT baseline):â€“ Account: 402.10 USDTâ€“ Risk: 2 % per tradeâ€“ Initial IM: 20 USDT per trade
ğŸ”¤ Terminology (consistent)
Use the term SSoT (Single Source of Truth) consistently throughout the document. Replace any variants (SSOT, SSoS, ssos) with SSoT (Single Source of Truth).
Checklist â€“ everything implemented:âœ” 3 whitelisted sources in SSoT â€¢ âœ” Startup print with â€œgreen checkâ€ and baseline 402.10 USDT â€¢ âœ” Normalization LONG/SHORT + tick/step â€¢ âœ” Dedup: HASH + TTL 2h â€¢ âœ” Dual-Limit + merging â€¢ âœ” TP/SL exactly according to signal (exception auto-SL) â€¢ âœ” Exit = reduce_only=true â€¢ âœ” Validation switches for both above â€¢ âœ” Timeouts 24h/6d, persistent â€¢ âœ” Bybit-first and mandatory template header â€¢ âœ” Terminology SSoT consistent.
here).
ğŸ—‚ï¸ A) Correct your existing â€œLoggingâ€ section
What must be changed
The phrase â€œTelegram notifications â€¦ are always sentâ€ conflicts with Bybit-first. It must be: sent only after acknowledgement; error messages are separate notifications.
Clarify timestamp policy: UTC as standard, alternative local time zone (Europe/Stockholm) via config.
Replace the entire â€œLoggingâ€ with:
Logging
â€¢ All events on Bybit are logged:
â€“ Order placement (request/payload)
â€“ Order acceptance (retCode, orderId)
â€“ Order fill (WS/REST fills)
â€“ SL/TP trigger (creation, update, fill)
â€“ Error messages (class: warning/critical)
â€“ Reconnects (WS/REST), backoff and recovery
â€¢ Logs are stored locally and are complete (lossless) and are correlated via bot_order_id â†” bybit_order_id/position_id.
â€¢ Telegram notifications follow standardized templates and are sent ONLY after Bybit acknowledgement (Bybit first). Error notifications are sent separately.
â€¢ All logs and messages are timestamped in UTC (standard). Local time zone can be enabled via config (Europe/Stockholm).
B) Add under â€œğŸ“¨ Signal Handlingâ€

Directly after the first paragraph (about receiving Telegram signals):
Standardization of outgoing messages
No raw forwards from source channels. All messages forwarded to our groups MUST be created from our standardized templates and contain all calculated fields (no copied text).

After the symbol support (binds flows to SSoT):
Category & flows (SSoT)
The botâ€™s market flows are connected to Bybit v5 linear (USDT-perpetual) public WS. This does not affect the interpretation of incoming signal formats but governs tick/step normalization and instrument specifications.
C) â€œğŸ“ˆ Entry & Order Placementâ€ â€“ insert confirmation chain
Placement: after the introduction in the section
Confirmation requirements before publishing (Bybit first)
â€“ ORDER_PLACED is published ONLY after Bybit response with retCode=0 and valid orderId.
â€“ POSITION_OPENED is published ONLY after private WS event or polling that confirms that the position is actually opened (executedQty > 0).
â€“ TP_SL_SET is published ONLY after confirmation that all TP/SL orders are created/updated.
D) New heading: â€œğŸ“£ Telegram Templates (mandatory fields)â€
(If you do not want a new heading this can be placed at the end of â€œğŸ“ˆ Entry & Order Placementâ€.)
ğŸ“£ Telegram Templates (mandatory fields)
The following placeholders MUST exist and be filled in at publishing:
{order_id}, {post_only}, {reduce_only}, {im_confirmed}, {source_channel_name}.
{im_confirmed} is fetched explicitly from Bybit response/positions data (must NOT be assumed or locally calculated). Empty/Null/None/"" is not allowed.
E) New heading: â€œğŸ” Sources & Telegram Clientâ€
Important on conflict: Earlier decision was â€œOnly three (3) sourcesâ€. Below we lock exactly three and name them. (Remove all wording that suggests â€œadditional sources may occurâ€.)
ğŸ” Sources & Telegram Client
â€¢ Telegram client: Only Pyrogram may be used.
â€¢ Sources (whitelist, SSoT): Only three (3) defined sources are monitored and processed:
â€“ CRYPTORAKETEN
â€“ LUX_LEAK
â€“ SMART_CRYPTO
â€¢ All Telegram parameters for these sources (channel_id, title, username, invite_link etc.) MUST be whitelisted in SSoT (Single Source of Truth).
â€¢ Changes to sources require the ownerâ€™s explicit approval and SSoT update in a signed release (see â€œğŸš¦ Safe startup / productionâ€).
F) New heading: â€œğŸ§ª Duplicate and Variant Controlâ€
Here we harmonize variants: Swedish standard SWING, DYNAMIC, FAST. (If you have older text with DYNAMIC/FIXED: replace them with DYNAMIC/FAST.)
ğŸ§ª Duplicate and Variant Control
â€¢ Signal variants (allowed): SWING, DYNAMIC, FAST. (Synonyms: DYNAMIC â†’ DYNAMIC, FIXED â†’ FAST.)â€¢ Other variants are not allowed in templates or runtime.â€¢ Deduplication: as in â€œDuplication guardâ€ + HASH+TTL (2h) according to SSoT.
G) New heading: â€œğŸš¦ Safe Startup / Productionâ€
ğŸš¦ Safe Startup / Production
The bot may be run against mainnet only when a signed release is validated with a governance token (checked in runtime code). Otherwise the bot runs in demo mode. This rule is process and security related; no API keys or secrets are documented here.
Summary check (Telegram requirements updated correctly)
âœ… Bybit-first is reflected in Logging and Confirmation requirements before publishing.
âœ… No raw forwards: Standardization of outgoing messages added in Signal Handling.
âœ… Template fields for Telegram (incl. {im_confirmed} from Bybit) defined.
âœ… Source whitelist: exactly 3 sources named, Pyrogram requirement clear, linked to SSoT.
âœ… Variants locked: SWING, DYNAMIC, FAST (with synonym mapping).
âœ… Flow binding to Bybit v5 linear in Signal Handling.
âœ… Governance gate for production added.
Sync points to mirror fully in the governing documents
Dual-Limit & Merging with Î” and páµ£ formula; postOnly=true, GTC, 50/50; maker protection (tick adjustment)
What my bot must do 2025-09-07
.
Dynamic leverage (the formula, clamping, classification SWING â‰¤ 6.00Ã— / DYNAMIC â‰¥ 7.50Ã— / FAST fallback when SL is missing = âˆ’2.00 %, x10.00)
What my bot must do 2025-09-07
.
Bybit-first flow and the mandatory template header
What my bot must do 2025-09-07
.
Dedup HASH + TTL 2h in addition to the percentage thresholds
What my bot must do 2025-09-07
.
Exits reduce_only=true and TP/SL exactly according to signal (exception: auto-SL fallback)
What my bot must do 2025-09-07
.
Timeouts 24h/6d for order cleanup (persistent jobs)
What my bot must do 2025-09-07
.
Startup (green check) with baseline 402.10 USDT and Bybit/Telegram acknowledgement per line â€“ must be present in Runbook and README (startup section)
Additions that must go into the Word documents (for full mirroring)
Insert the following text sections into â€œWhat my bot must doâ€ and where needed into â€œTelegram messagesâ€:
Pyrogram exclusivityâ€œTelegram client: Only Pyrogram is used. Other clients (e.g. Telethon) are prohibited.â€
Dual-Limit & Merge (replaces Above/Below)â€œOrder plan: Dual-Limit & merging (Î” model). Two Post-Only GTC entries around target level Eâ‚˜ Â± Î”. Merge-on-first-fill secures final avg_entry = Eâ‚˜. Above/Below does not occur in the system.â€
Startup baseline + header requirementsâ€œStartup message shows Balance baseline: 402.10 USDT (SSoT) âœ… and Cleanup timeouts: 24h/6d. All operations templates have the top line â€˜SENT ONLY AFTER BYBIT CONFIRMATIONâ€™.â€
TP/SL accuracyâ€œTP and SL are set exactly according to the signal. Exception: SL missing in source â†’ auto-SL = âˆ’2.00 % and leverage FAST x10.00.â€
DEMO lockâ€œRuntime environment: Bybit DEMO only. All REST/WS endpoints are DEMO. (Production requires separate governance release.)â€
Performance/â€œfast botâ€â€œRequirement: REST latency â‰¤ 500 ms p95, WS heartbeat â‰¤ 30 s, effective rate-limit handling, no blocking chokepoints in the main loop. Deviation â‡’ operations are blocked until fixed.â€
Manual checksâ€œAll verification in production is done manually, step by step, with after-check before the next step. No automated tests in production.â€
Extra: items that â€œmust go in Wordâ€ if they are not already there
(Most are already present, but add if something is missing.)
Presentation standard for Telegram (Swedish) â€“ a normative line in Word about comma as decimal separator and space before % and xNN,NN for leverage.
Telegram messages
Startup conditions in clear text: retCode=0, RESTâ‰¤500 ms p95, WSâ‰¤30 s, can_send=true, governance OK, JSONL logging with message_text_hash and trace_id. (It is in your English startup template; mirror it in Swedish in

What my bot must do 2025-09-07.docx â€” OK, but reinforcements
This Word document contains in principle all requirements we base the governing documents on: Pyrogram exclusivity, 3 sources (whitelist/SSoT), Dual-Limit Î” model, Dynamic leverage (Î”), Bybit-first + header, Dedup HASH+TTL 2h, reduce_only on exits, TP/SL exact, timeouts 24h/6d, startup baseline 402.10 and performance thresholds + manual control.
Recommended minor adjustment (optional clarification):
Insert a short norm line for Swedish Telegram format (decimal mark, space before %) directly in the section about templates, so it cannot be misinterpreted. (It is already in â€œTelegram messagesâ€, but good to mirror the sentence here as well.)
Telegram messages
Otherwise: no change needed; this is the source SSoT.
ENGLISH
T G+46
703689310